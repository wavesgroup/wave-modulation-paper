\documentclass[lineno]{jfm}

\usepackage{graphicx}
%\usepackage{epstopdf,epsfig}
\usepackage{newtxtext}
\usepackage{newtxmath}
\usepackage{natbib}
\usepackage{hyperref}
\hypersetup{
    colorlinks = true,
    urlcolor   = blue,
    citecolor  = black,
}
\newtheorem{lemma}{Lemma}
\newtheorem{corollary}{Corollary}
\newcommand{\RomanNumeralCaps}[1]
\linenumbers


% {\MakeUppercase{\romannumeral #1}}

\title{Revisiting the hydrodynamic modulation of short waves by longer waves}

\author{
  Milan Curcic\aff{1}
  \corresp{\email{mcurcic@miami.edu}}
}

\affiliation{
  \aff{1}Rosenstiel School of Marine, Atmospheric, and Earth Science, University of Miami, Miami, FL
  \aff{2}Frost Institute for Data Science and Computing, University of Miami, Coral Gables, FL
}

\begin{document}
\maketitle

\begin{abstract}
Hydrodynamic modulation of short ocean surface waves by longer ambient waves is
a well-known ocean surface process that affects remote sensing, the
interpretation of \textit{in situ} wave measurements, and numerical wave
forecasting.
In this paper, we revisit the linear wave theory and derive higher-order
solutions for the change of short-wave wavenumber, action density, and
gravitational acceleration due to the presence of longer waves.
We validate the analytical solutions with numerical simulations of the full wave
crest and action conservation equations.
The nonlinear analytical solutions of short-wave wavenumber, amplitude, and
steepness modulation significantly deviate from the linear analytical solutions
of \citet{longuet1960changes}, and are similar to the nonlinear numerical
solutions by \citet{longuet1987propagation} and \citet{zhang1990evolution}.
We also examine the result of \citet{peureux2021unsteady} who found through
numerical simulations that the short-wave modulation grows unsteadily with
each long-wave phase.
We show that this unsteady growth only occurs for homogeneous initial
conditions and does not occur for more realistic long-wave groups.
The combined analytical and numerical framework presented here allows
quantifying the importance of various terms in the full wave conservation
equations.
The proposed analytical solutions are a good approximation of the fully
nonlinear numerical solutions in long-wave steepness up to $\approx 0.2$.
\end{abstract}

\begin{keywords}
%Authors should not enter keywords on the manuscript, as these must be chosen by the author during the online submission process and will then be added during the typesetting process (see \href{https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/information/list-of-keywords}{Keyword PDF} for the full list).  Other classifications will be added at the same time.
\end{keywords}

%{\bf MSC Codes }  {\it(Optional)} Please enter your MSC Codes here

\section{Introduction}

Short ocean surface waves are modulated by longer swell.
Following \citet{unna1941white,unna1942waves,unna1947sea},
\citet{longuet1960changes} introduced a steady, approximate solution for
hydrodynamic modulation of short waves by longer waves:

\begin{equation}
\label{eq:lhs1960wavenumber}
\widetilde{k} = k (1 + \varepsilon_L)
\end{equation}
where $\widetilde{k}$ and $k$ are the modulated and unmodulated short-wave wavenumbers,
respectively, and $\varepsilon_L = a_L k_L$ is the steepness of the long wave with
wavenumber $k_L$ and amplitude $a_L$.
This result influenced the development of remote sensing of ocean
surface waves and currents \citep{keller1975microwave,hara1994hydrodynamic}.
\citet{phillips1981dispersion} and \citet{longuet1987propagation} revisited this
problem by nonlinear long waves and variations in the effective gravity of short
waves, yielding significantly stronger modulation than previously predicted.
\citet{henyey1988energy} derived an analytical solution for the modulation of
short waves by long waves using Hamiltonian mechanics and reported the modulation
of similar magnitude to that of \citet{longuet1987propagation}.
\citet{zhang1990evolution} considered weakly nonlinear short waves
using a non-linear Schr\" odinger equation and found stronger wavenumber
modulation but weaker amplitude modulation than those predicted by
\citet{longuet1987propagation}.
The variety of analytical and numerical frameworks (Eulerian, Hamiltonian,
Schr\" odinger) that relatively closely reproduce steady solutions for short-wave
modulation suggests that the solutions are robust.
Alternative analytical and numerical approaches to the modulation problem remain
of interest, especially if higher degrees of nonlinearity can be considered
using simpler approaches.

More recently, \citet{peureux2021unsteady} asked whether the steady solutions
of short-wave modulation are realistic by simulating the full wave conservation
equations.
They found that the short waves grow unsteadily due to the propagation of
longer waves, suggesting that the steady-state solutions may only be valid for
a few long-wave periods before the short waves begin to break due to excessive
steepness.
However, the unsteadiness of their solutions occurs in a specific scenario of
a uniform short-wave field that suddenly appears in a uniform long-wave train,
and the numerical simulations stabilize if the short-wave field is initialized
from existing steady solutions.
Nevertheless, their results do put into question whether the short-wave
modulation predicted by theory is generally steady over many long-wave periods
or not.

In this paper, we revisit this problem from linear wave theory and
derive alternative non-linear solutions for the modulation of short waves,
evaluated at the long-wave surface.
The analytical solutions yield modulations that are stronger than the original solution
by \citet{longuet1960changes}, but similar to the nonlinear numerical solutions
by \citet{longuet1987propagation} and \citet{zhang1990evolution} in long-wave
steepness up to $\approx 0.2$.
We also perform numerical simulations of the full wave crest and action
conservation laws and evaluate the effect of long-wave groups on the short waves.
The numerical simulations are used to determine the validity of the approximate
steady solution and to investigate the unsteadiness of the short-wave modulation
found by \citet{peureux2021unsteady}.
The main prior studies on hydrodynamic modulation, and their assumptions and
approaches to the solution, are summarized in Table
\ref{table:modulation_literature_summary}.

\begin{table}
\begin{center}
\def~{\hphantom{0}}
\begin{tabular}{cccccc}
Reference   & Governing & Gravity & Nonlinear  & Nonlinear   & Solution \\
            & equations & varies  & long waves & short waves &          \\
\hline
L-HS 1960   & Velocity potential  & No  & No  & No  & Analytical \\
\hline
P 1981      & Crest and action    & Yes & Yes & No  & Numerical \\
            & conservation        &     &     &     &           \\
\hline
L-H 1987    & Velocity potential  & Yes & Yes & No  & Numerical \\
\hline
HCDSW 1988  & Hamiltonian         & Yes & Yes & No  & Analytical \\
\hline
ZM 1990     & Schr\" odinger      & Yes & Yes & Yes & Numerical \\
\hline
PAG 2021    & Crest and action    & Yes & No  & No  & Numerical \\
            & conservation        &     &     &     &           \\
\hline
This paper  & Crest and action    & Yes & Yes & No  & Analytical \\
            & conservation        &     &     &     & and numerical \\
\hline
\end{tabular}
\caption{
  Summary of prior
  \citep{longuet1960changes,phillips1981dispersion,longuet1987propagation,henyey1988energy,zhang1990evolution,peureux2021unsteady}
  and present (this paper) approaches to calculating the modulation of short
  waves by long waves.
}
\label{table:modulation_literature_summary}
\end{center}
\end{table}

This paper first presents the governing equations and then the analytical
solutions for the modulation of short waves by long waves and compares them to
the original solution by \citet{longuet1960changes}.
Then, we compare the analytical solutions to numerical solutions of the full
wave conservation equations in section \ref{section:numerical_solutions}.
In section \ref{section:scale_analysis} we perform a scale analysis of the
analytical solutions to quantify the relative importance of the terms in the
full equation set.
Finally, we summarize the results and discuss their implications in section
\ref{section:conclusions}.

\section{Governing equations}
\label{section:governing_equations}

We consider inviscid, irrotational, and incompressible flow.
In these conditions the linear (sine-like), deep-water, surface gravity waves
obey the dispersion relation:

\begin{equation}
\label{eq:dispersion}
\omega = \sqrt{gk} + k U
\end{equation}
where $\omega$ is the angular frequency, $g$ is the gravitational acceleration,
$k$ is the wavenumber, and $U$ is the mean advective current in the direction
of the wave propagation.
A current in the direction of the waves increases its absolute frequency,
while the wavenumber remains unchanged.
An important limitation here is that $U$ must be slowly varying on the scales of
the wave period \citep{bretherton1968wavetrains}.
In the context of short waves riding on long waves, the mean advective current
is the horizontal near-surface orbital velocity of the long wave.
The evolution of the short-wave wavenumber is described by the conservation of
wave crests \citep{phillips1981dispersion}:

\begin{equation}
\label{eq:wave_crests}
\dfrac{\partial k}{\partial t}
+ \dfrac{\partial \omega}{\partial x}
= 0
\end{equation}
where $t$ and $x$ are time and space, respectively.
This relation states that the wavenumber must change when the frequency varies
in space.

Equations (\ref{eq:dispersion}) and (\ref{eq:wave_crests}) only describe the
evolution of the short-wave wavenumber.
To describe the evolution of the wave amplitude, we use the conservation of wave
action in absence of sources (e.g. due to wind) and sinks (e.g. due to whitecapping):

\begin{equation}
\label{eq:wave_action}
\dfrac{\partial N}{\partial t}
+ \dfrac{\partial}{\partial x} \left[\left(C_g + U\right)N\right]
= 0
\end{equation}
where $N$ is the action density, and $C_g = \partial \omega / \partial k$ is the
group speed.
In deep water, the group speed is half the phase speed, so $C_g = 1/2\sqrt{g/k}$.
Although the absence of wave growth and dissipation is not generally realistic
in the open ocean, it is a helpful approximation that allows us to isolate the
hydrodynamic modulation effects solely due to the motion of the long waves.

Short waves that ride on the surface of the longer waves move in an accelerated
reference frame and thus experience effective gravitational acceleration that
changes in space and time \citep{phillips1981dispersion,longuet1986eulerian,longuet1987propagation}.
From Eqs. (\ref{eq:dispersion}) and (\ref{eq:wave_action}) we obtain:

\begin{equation}
\label{eq:wavenumber}
\dfrac{\partial k}{\partial t}
+ \left(C_g + U\right) \dfrac{\partial k}{\partial x}
+ k \dfrac{\partial U}{\partial x}
+ \dfrac{1}{2} \sqrt{\dfrac{k}{g}} \dfrac{\partial g}{\partial x}
= 0
\end{equation}
From left to right, the terms in this equation represent the change in wavenumber
due to the propagation and advection by ambient current $U$, the convergence of
the ambient current, and the spatial inhomogeneity of the gravitational acceleration.
In a non-accelerated reference frame (i.e. in absence of longer waves), the last
term vanishes.
Otherwise, this term is necessary to conserve the wave crests.

Similar to Eq. \ref{eq:wavenumber}, we expand Eq. \ref{eq:wave_action} to obtain:

\begin{equation}
\label{eq:wave_action2}
\dfrac{\partial N}{\partial t}
+ \left(C_g + U\right) \dfrac{\partial N}{\partial x}
+ N \dfrac{\partial U}{\partial x}
+ N \dfrac{\partial C_g}{\partial x}
= 0
\end{equation}
This equation is similar to Eq. \ref{eq:wavenumber}, except for the last term
which here represents the inhomogeneity of the group speed.
As \citet{peureux2021unsteady} explained, this term is responsible for unstable
growth of wave action in infinite long-wave trains.
Eqs. \ref{eq:wavenumber} and \ref{eq:wave_action2} are the governing equations
that we approximate and solve analytically in section \ref{section:analytical_solutions},
and solve numerically in their full form in section \ref{section:numerical_solutions}.

For the ambient forcing, we consider a train of monochromatic long wave
defined, to the first order in steepness, by the elevation $\eta_L = a_L cos{\psi}$,
where $\psi = k_L x - \omega_L t$ is the long-wave phase and $\omega_L$ its
angular frequency.
The long wave induces horizontal and vertical orbital velocities whose values
at the surface $\eta_L$ are:

\begin{equation}
\label{eq:U_L}
U = a_L \omega_L e^{\varepsilon_L \cos{\psi}} \cos{\psi}
\end{equation}

\begin{equation}
\label{eq:w_L}
W = a_L \omega_L e^{\varepsilon_L \cos{\psi}} \sin{\psi}
\end{equation}

Eqs. \ref{eq:dispersion}-\ref{eq:w_L} is the full system of equations that we
use in this paper.
Note that here we derive the solutions from a different starting set of
equations than that of \citet{longuet1960changes}.
Rather than starting from the conservation of crests and wave action, as we do
here, they derived their solution from the linear superposition of the velocity
potential of two waves.
It appears that starting from the conservation of crests and wave action allows
for a simpler and more intuitive derivation.

\section{Analytical solutions}
\label{section:analytical_solutions}

We now describe the analytical solutions for the short-wave wavenumber,
effective gravitational acceleration, amplitude, steepness, intrinsic frequency,
and intrinsic phase speed in presence of long waves.
The wavenumber is derived by linearizing the conservation of wave crests
(Eq. \ref{eq:wave_crests}) and neglecting the spatial gradients of $k$.
The effective gravity is derived by projecting the long-wave induced surface
accelerations onto the axis that is normal to the long-wave surface.
(Eq. \ref{eq:wave_action2}) and using the expression for the long-wave orbital
velocities.
The amplitude is derived by first evaluation the short-wave action from the
action conservation equation (Eq. \ref{eq:wave_action}) and then applying the
modulated effective gravity to obtain the amplitude.
From the modulated wavenumber, amplitude, and effective gravity, the steepness,
frequency, and phase speed readily follow from the usual wave relationships.
Going forward we will use the tilde over the variables to denote the modulated
quantities (e.g. $\widetilde{k}$ for wavenumber).

\subsection{Wavenumber modulation}
\label{subsection:wavenumber_modulation}

Solving analytically for the wavenumber requires dropping spatial gradients of
$k$ in Eq. \ref{eq:wavenumber} and assuming homogeneous $g$:

\begin{equation}
\label{eq:wavenumber2}
\dfrac{\partial k}{\partial t}
= - k \dfrac{\partial U}{\partial x}
\end{equation}
Although \citet{peureux2021unsteady} pointed out that the solution by L-HS
requires assuming homogeneous group speed of the short-wave field, in fact,
it also requires assuming no horizontal propagation and advection of the short
waves.
Combining Eqs. \ref{eq:U_L} and \ref{eq:wavenumber2}, and integrating it in time
yields:

\begin{equation}
\label{eq:k_short_exact}
\frac{\widetilde{k}}{k} = e^{\varepsilon_L \cos{\psi} e^{\varepsilon_L \cos{\psi}}}
\end{equation}

Notice that the Taylor expansion of Eq. \ref{eq:k_short_exact} to the first order
recovers the original solution by \citet{longuet1960changes}:

\begin{equation}
\label{eq:k_short_lhs}
\frac{\widetilde{k}}{k} = 1 + \varepsilon_L \cos{\psi}
\end{equation}
Coming from the conservation of wave crests, as opposed to the velocity potential
superposition approach, the L-HS solution requires two approximations in their
solution:
First, evaluating the long-wave velocity at $z = 0$ rather than $z = \eta_L$; and
second, further truncating the Taylor expansion series beyond the first order term.
These approximations cause an underestimate of the short-wave modulation
magnitude (Fig. \ref{fig:analytical_solutions_ak0.1}a).
At the wave crest, Eq. \ref{eq:k_short_exact} yields the wavenumber modulation
that is 16.9\%, 38.5\%, 66.4\%, and 104\% larger than that of \citet{longuet1960changes}
for $\varepsilon_L = 0.1, 0.2, 0.3, 0.4$, respectively.
Although not immediately obvious from the expressions, the modulated wavenumber
in Eq. \ref{eq:k_short_lhs} is conservative across the long-wave phase, whereas
the higher-order solution in Eq. \ref{eq:k_short_exact} is not.
This is due to the fact that combining the orbital velocities evaluated at
$z=\eta$ and the linearized conservation of wave crests in Eq. \ref{eq:wavenumber}
results in excess short-wave wavenumber being created.
The solution of the full Eq. \ref{eq:wavenumber} of course must be conservative
across the long-wave phase, as we will see later from the numerical simulations.

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/fig_analytical_solutions_ak0.1.png}
\caption{
  Steady solutions for the modulation of short-wave (a) wavenumber, (b)
  gravitational acceleration, (c) amplitude, (d) steepness, (e) intrinsic
  frequency, and (f) intrinsic phase speed as function of long-wave phase for
  $\varepsilon_L = 0.1$, based on
  \citet{longuet1960changes} (L-HS 1960, black) and this paper (blue).
  Long-wave crest and trough are located at $\psi = 0$ and $\psi = \pi$,
  respectively.
}
\label{fig:analytical_solutions_ak0.1}
\end{figure}

\subsection{Gravity modulation}
\label{subsection:gravity_modulation}

Long waves induce orbital accelerations, so the short waves that ride on their
surface move in an accelerated reference frame and experience effective
gravitational acceleration that is lower at the crests and higher in the troughs
\citep{longuet1986eulerian,longuet1987propagation}.
Further, centripetal force due to the curvature of the long wave induces small
but non-negligible effects on the short-wave effective gravity
\citep{phillips1981dispersion,zhang1990evolution}.
These effects are completely described by projecting the gravitational
acceleration from the coordinate that is perpendicular to the mean water surface
($z=0$) to that which is perpendicular to the long-wave surface ($z=\eta$),
and likewise for the long-wave orbital accelerations:

\begin{equation}
\label{eq:gravity_modulation_general}
\frac{\widetilde{g}}{g}
  = \cos{\alpha} 
  + \dfrac{\partial W_{z=\eta}}{\partial t} \cos{\alpha}
  + \dfrac{\partial U_{z=\eta}}{\partial t} \sin{\alpha}
\end{equation}

\begin{equation}
\label{eq:local_slope}
\alpha = \tan^{-1}{\dfrac{\partial \eta}{\partial x}}
\end{equation}
where $\alpha$ is the local slope of the long-wave surface.
For a linear long wave, the effective gravity is:

\begin{equation}
\label{eq:gravity_modulation_linear}
\frac{\widetilde{g}}{g}
  = 
  \frac{
    1 - \varepsilon_L \cos{\psi} e^{\varepsilon_L \cos{\psi}}
    \left[ 1 + \left(\varepsilon_L \sin{\psi}\right)^2 \right]
  }
  {\sqrt{\left(\varepsilon_L \sin{\psi}\right)^2 + 1}}
\end{equation}

Curvilinear effects on effective gravity can be removed altogether by setting
$\alpha = 0$.
In that case, Eq. \ref{eq:gravity_modulation_general} simplifies to:

\begin{equation}
\label{eq:gravity_modulation_linear_no_curvature}
\frac{\widetilde{g}}{g} = \left( 1 - \varepsilon_L \cos{\psi} e^{\varepsilon_L \cos{\psi}} \right)
\end{equation}
Further, if we evaluate the orbital accelerations at the mean water level $z=0$,
this further simplifies to:

\begin{equation}
\label{eq:gravity_modulation_linear_no_curvature_mean_level}
\widetilde{g} = \left( 1 - \varepsilon_L \cos{\psi} \right)
\end{equation}
which is the form used by \citet{peureux2021unsteady}, for example.

The general form of the gravity modulation in Eq. \ref{eq:gravity_modulation_general}
is convenient because it allows us to easily attribute the effects of the different
processes on the gravity modulation.
It also makes it straightforward to evaluate the gravity modulation for a different
form of the long-wave elevation, by evaluating the orbital accelerations and the
local elevation slope at the appropriate level.
For a third-order Stokes wave, for example, the elevation is:

\begin{equation}
\label{eq:eta_stokes}
\eta_{St} = a_L \left[
  \cos{\psi} +
  \dfrac{1}{2} \varepsilon_L \cos{2\psi} +
  \varepsilon_L^2 \left( \dfrac{3}{8} \cos{3\psi} - \dfrac{1}{16} \cos{\psi} \right)
\right]
\end{equation}
Without considering the curvilinear effects in Eq. \ref{eq:gravity_modulation_general},,
the gravitational acceleration at the surface of a Stokes wave is, to the
fourth order:

\begin{equation}
\label{eq:gravity_modulation_stokes}
\frac{\widetilde{g}}{g} =
\left\{
  1 - \varepsilon_L e^{k \eta_{St}}
  \left[ \cos{\psi} -
    \varepsilon_L \sin{\psi} \left(
      \sin{\psi}
      + \varepsilon_L \sin{2\psi}
      - \dfrac{1}{16} \varepsilon_L^2 \sin{\psi}
      + \dfrac{9}{8} \varepsilon_L^2 \sin{3\psi}
    \right)
  \right]
\right\}
\end{equation}
The equivalent expression that includes the curvilinear effects can be derived
by evaluating orbital accelerations and local slope $\alpha$ at $z = \eta_{St}$,
and inserting them into Eq. \ref{eq:gravity_modulation_general}:

\begin{equation}
\label{eq:gravity_modulation_general_stokes}
\frac{\widetilde{g}}{g}
  = \cos{\alpha} 
  + \dfrac{\partial W_{z=\eta_{St}}}{\partial t} \cos{\alpha_{St}}
  + \dfrac{\partial U_{z=\eta_{St}}}{\partial t} \sin{\alpha_{St}}
\end{equation}

\begin{equation}
\label{eq:local_slope_stokes}
\alpha_{St} = \tan^{-1}{\dfrac{\partial \eta_{St}}{\partial x}}
\end{equation}

Let us now examine the contributions of the different terms to the short-wave
effective gravity modulation.
Fig. \ref{fig:effective_gravities}a shows the effective gravity modulation of
short-wave as a function of the long-wave phase for $\varepsilon_L = 0.2$, for
a variety of the gravity modulation forms.
This value of $\varepsilon_L$ allows easier visualization of the modulation
differences, while still being relatively moderate.
To the first order in $\varepsilon_L$, the gravity modulation is out of phase
with the long-wave elevation, with the short waves experiencing a lower effective
gravity on the long-wave crests and a higher effective gravity in the troughs.
Evaluating the orbital accelerations at $z=\eta$ causes a gravity reduction
around the crests ($\approx6\%$) and the troughs ($\approx 3\%$), and an
increase on the front and rear faces ($\approx 4\%$) of the long wave, due to
the exponential change in the orbital accelerations away from the mean water level
(Fig. \ref{fig:effective_gravities}b).
The difference between the linear and Stokes long waves at this steepness is
negligible.
The long-wave elevation curvature has a second-order effect in $\varepsilon_L$.
Naturally, there is no curvature exactly at the crests and troughs, and its
effects are largest at the front and rear faces of the long wave, where the
covariance between the local slope and the horizontal accelerations are greatest.

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/fig_effective_gravities.png}
\caption{
  (a) Analytical solutions for the effective gravitational acceleration
  modulation by long waves, as function of long-wave phase, for $\varepsilon_L = 0.2$.
  Black is for linear wave evaluated at $z=0$,
  blue and green are for linear and Stokes waves, respectively, evaluated at $z=\eta$ and without curvature effects,
  and orange and green are for linear and Stokes waves, respectively, evaluated at $z=\eta$ and with curvature effects.
  (b) As in (a) but normalized by the modulation of the linear wave evaluated at $z=0$, $g_1$.
}
\label{fig:effective_gravities}
\end{figure}

It is instructive to also examine the mean, maximum, and minimum values of the
effective gravity as function of long-wave steepness $\varepsilon_L$
(Fig. \ref{fig:effective_gravities_mean_max_min}).
The long-wave averaged effective gravity of short waves remains equal to the
resting value of $g$ for all values of $\varepsilon_L$, except if the effects
of curvature are considered, in which case the average effective gravity is
reduced.
This reduction, in case of a long Stokes wave, is $\approx 3\%$ for
$\varepsilon_L = 0.2$ and $\approx 14\%$ for $\varepsilon_L = 0.4$.
As the effective gravity minima and maxima occur at crests and troughs,
respectively, the curvature affects the phase-averaged values but not the extremes.
The effective gravity reduction at the crests is $\approx 11\%$, $25\%$, and $66\%$
for $\varepsilon_L = 0.1$, $0.2$, and $0.4$, respectively.
These are similar to the fully-nonlinear numerical estimates of
\citet{longuet1986eulerian,longuet1987propagation}.
Note that these are strictly Eulerian values, evaluated at fixed positions in
space.
As \citet{longuet1986eulerian} pointed out, the effective gravity in the
Lagrangian frame is smoother and less amplified because the moving particles
spend a longer time riding near the crests and less time returning through the
troughs.
However, when we solve the short-wave crest and action conservation equations
in an Eulerian frame, it is the Eulerian effective gravity that must be applied
to conserve the short-wave properties across the long-wave phase.

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/fig_effective_gravities_mean_max_min.png}
\caption{
  As Fig. \ref{fig:effective_gravities} but showing the mean (solid),
  maximum (dashed), and minimum (dotted) short-wave gravity modulation as
  function of long-wave steepness $\varepsilon_L$.
  The minimum and maximum values for the cases with curvature effects
  ($\alpha=\frac{\partial \eta}{\partial x}$) are equivalent to those without
  curvature effects ($\alpha=0$) and obscure them in the plot.
}
\label{fig:effective_gravities_mean_max_min}
\end{figure}

\subsection{Amplitude and steepness modulation}
\label{subsection:amplitude_modulation}

The modulation of short-wave amplitude can be derived in a similar way as we did
for the wavenumber, except that here we linearize the wave action balance and
integrate wave action in time:

\begin{equation}
\label{eq:wave_action_modulation}
\frac{\widetilde{N}}{N} = e^{\varepsilon_L \cos{\psi} e^{\varepsilon_L \cos{\psi}}}
\end{equation}

Since wave action is energy divided by the intrinsic frequency $\sigma$,
and energy scales with $ga^2$, the modulation of the amplitude is related to the
modulations of gravity, wavenumber, and action:

\begin{equation}
\label{eq:wave_amplitude_modulation}
\dfrac{\widetilde{a}}{a} = \sqrt{
  \dfrac{g}{\widetilde{g}}
  \dfrac{\widetilde{\sigma}}{\sigma}
  \dfrac{\widetilde{N}}{N}}
=
  \left( \dfrac{g}{\widetilde{g}} \right)^{0.25}
  \left( \dfrac{\widetilde{k}}{k} \right)^{0.25}
  \left( \dfrac{\widetilde{N}}{N} \right)^{0.5}
\end{equation}
To the first order in $\varepsilon_L$, and using Eqs. \ref{eq:k_short_exact}
and \ref{eq:wave_action_modulation}, the above simplifies to:

\begin{equation}
\label{eq:wave_amplitude_modulation_order1}
\dfrac{\widetilde{a}}{a} = 
  \left( \dfrac{g}{\widetilde{g}} \right)^{0.25}
  \left( 1 + \varepsilon_L \right)^{0.75}
\end{equation}

The amplitude and steepness modulation of the short waves as a function of the
long-wave phase for $\varepsilon_L = 0.1$, $0.2$, and $0.4$ are shown and compared
to the \citet{longuet1960changes} solutions in Figs.
\ref{fig:analytical_solutions_ak0.1}, \ref{fig:analytical_solutions_ak0.2},
and \ref{fig:analytical_solutions_ak0.4}, respectively.
Also shown are the modulation of the short-wave intrinsic frequency and phase
speed in panels (e) and (f), respectively.
As the wavenumber and gravity modulations are out of phase, with the latter
being somewhat larger in magnitude, the overall intrinsic frequency of the
short waves is reduced across the entire long-wave phase, with highest reduction
at the long-wave crests.
For the short-wave phase speed modulation, the wavenumber and gravity modulations
work in tandem and cause the short-wave phase speed to be reduced on the long-wave
crests and increased in the troughs.
We will discuss the implications of this effect later in the context of wind
input into short waves.

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/fig_analytical_solutions_ak0.2.png}
\caption{As Fig. \ref{fig:analytical_solutions_ak0.1} but for $\varepsilon_L = 0.2$.}
\label{fig:analytical_solutions_ak0.2}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/fig_analytical_solutions_ak0.4.png}
\caption{As Fig. \ref{fig:analytical_solutions_ak0.1} but for $\varepsilon_L = 0.4$.}
\label{fig:analytical_solutions_ak0.4}
\end{figure}

\section{Numerical solutions}
\label{section:numerical_solutions}

To quantify the contribution of the nonlinear terms in Eqs. \ref{eq:wavenumber}
and \ref{eq:wave_action2}, and to evaluate the steadiness assumption of the
analytical solutions, we now proceed to numerically integrate the full set of
crest and action conservation equations.
Equations (\ref{eq:wavenumber})-(\ref{eq:wave_action2}) are discretized using
second-order central finite difference in space and integrated in time using the
forth-order Runge-Kutta method \citep{butcher1996runge}.
The space is divided into 100 grid points.
This is effectively the same equation set and numerical configuration as that of
\citet{peureux2021unsteady}, except that their long-wave orbital velocities are
evaluated at $z=0$ instead of $z=\eta_L$, thus neglecting the Stokes drift
induced by long waves on short-wave groups
\citep{stokes1846,van2018stokes,monismith2020stokes}.
Their gravity modulation also does not consider the nonlinear or the curvature
effects, however, this difference does not qualitatively affect the results.
Another difference is the choice of the numerical scheme for spatial differences,
which in their case is the MUSCL4 scheme by \citet{kurganov2000new}.
Although the second-order central finite difference is not appropriate for many
numerical problems, in our case it is sufficient because it is conservative and
the fields that we compute derivatives of are smooth and continuous.
The maximum relative error of the centered finite difference in this model
is $\approx 0.066\%$.
We show in the next section that our numerical solutions for infinite long-wave
trains are qualitatively equivalent to those of \citet{peureux2021unsteady}.

Finally, the numerical equations here are integrated in a fixed reference frame,
rather than that moving with the long-wave phase speed.
Either approach produces qualitatively equivalent results, however a fixed
reference frame may allow for a more intuitive interpretation of the results.
This difference is important to keep in mind when comparing the results
of \citet{peureux2021unsteady} and those presented here; in their Fig. 1 the
long-wave phase is fixed and the short waves are moving leftward
with the speed of $C_{pL} - C_g - U$ (neglecting group speed inhomogeneity),
whereas in the figures that follow, the long wave is moving rightward with its
phase speed $C_{pL}$ and the short waves (that is, their energy) are moving
rightward with the speed of $C_g + U$ (neglecting group speed inhomogeneity).

\subsection{Comparison with analytical solutions}
\label{subsection:comparison_with_analytical_solutions}

The first set of simulations is performed for the long-wave steepness of
$\varepsilon_L = 0.1$, $0.2$, and $0.4$ (Fig. \ref{fig:numerical_solutions}).
The long-waves are initialized from rest ($a_L = 0$) and are ramped up
to their target steepness after 5 long-wave periods, thus mimicking the
passage of a long-wave group
(we explain in more detail the importance of ramping up the long-wave forcing
in the next subsection).
At $\varepsilon = 0.1$, the numerical solutions for the wavenumber, amplitude,
and steepness modulation are all remarkably similar to the analytical solutions
(Fig. \ref{fig:numerical_solutions}a,d,g).
This suggests that at low long-wave steepness that steady analytical solution
is a reasonable proxy for the fully-nonlinear crest-action conservation
equation solutions.
The numerical solutions diverge more notably from the analytical ones at
moderate steepness of 0.2 (Fig. \ref{fig:numerical_solutions}b,e,h), and are
considerably different at very high steepness of 0.4
(Fig. \ref{fig:numerical_solutions}c,f,i).
These differences suggest that at high steepness the inhomogeneity of
gravitational acceleration and group speed become important.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{figures/numerical_vs_analytical_solutions_with_phase.png}
\caption{
  Comparison of numerical solutions of wavenumber, amplitude, and steepness modulation
  with their analytical solutions, for $\varepsilon_L$ = 0.1, 0.2, and 0.4.
}
\label{fig:numerical_solutions}
\end{figure}

The maximum modulations of the short-wave wavenumber, amplitude, and steepness
from the analytical and numerical solutions, are shown on Figs.
\ref{fig:numerical_vs_analytical_k},
\ref{fig:numerical_vs_analytical_a}, and
\ref{fig:numerical_vs_analytical_ak}, respectively, as function of the long-wave
steepness $\varepsilon_L$.
Overall, the numerical solutions, based on the linear and third-order Stokes long wave
alike, begin to diverge from the analytical solution at $\varepsilon_L \approx 0.2$.
The numerical solution using the Stokes long wave is quantitatively very similar
to the fully-nonlinear solutions of \citet{longuet1987propagation} in amplitude
modulation, however with somewhat lower wavenumber and steepness modulations.
For example, at $\varepsilon_L = 0.4$, the steepness modulation in our solutions
is close to 6, whereas \citet{longuet1987propagation} finds it close to 8.
The underestimate in the wavenumber modulation at high long-wave steepness
relative to the results of \citet{longuet1987propagation}
is likely due to his long wave velocities being evaluated to a higher order
than they are here.
Nevertheless, the overall steepness modulation between the two numerical
approaches are remarkably similar, and either solution would cause the
short-waves of even low steepness to break \citep{banner1993wave}.

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/numerical_vs_analytical_solutions_k.png}
\caption{
  Maximum wavenumber modulation as function of long-wave steepness $\varepsilon_L$.
  Black line and circles are for the analytical and numerical solutions from
  \citet{longuet1960changes} and \citet{longuet1987propagation}, respectively.
  Blue line is based on the analytical solutions from this paper.
  Green and orange lines are for the numerical solutions from this paper
  using linear and third-order Stokes long waves, respectively.
}
\label{fig:numerical_vs_analytical_k}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/numerical_vs_analytical_solutions_a.png}
\caption{
  As Fig. \ref{fig:numerical_vs_analytical_k} but for the amplitude modulation.
}
\label{fig:numerical_vs_analytical_a}
\end{figure}

\begin{figure}
\centering
\includegraphics[width=0.8\textwidth]{figures/numerical_vs_analytical_solutions_ak.png}
\caption{
  As Fig. \ref{fig:numerical_vs_analytical_k} but for the steepness modulation.
}
\label{fig:numerical_vs_analytical_ak}
\end{figure}

\subsection{Unstable growth in Pereux et al. (2021)}
\label{subsection:unstable_growth}

The key result of \citet{peureux2021unsteady} is that of unsteady steepening of
short waves when a homogeneous field of short waves is forced by an infinite
long-wave train.
The steepening is driven by the progressive increase in the action of short
waves (as opposed to their wavenumber), and is centered on the group of short
waves that begins its journey in the trough of the long wave.
This is because the unmodulated short waves that begin their journey in the
trough first enter the convergence region before reaching the divergence region.
Inversely, the short waves that begin around the crest of the long-wave first
enter the divergence region and will thus have their action and wavenumber
decreased.
We reproduce this behavior in Fig. \ref{fig:modulation_3panel_infinite}, which
shows the evolution of the short-wave action, wavenumber, and steepness
modulation (here defined as the change of a quantity relative to its initial value).
The long waves have $\varepsilon_L = 0.1$ and $k_L = 1$, and the short waves
have $k = 10$.
After 10 long-wave periods, the short-wave action modulation $\widetilde{N}/N$
is approximately doubled, consistent with the unsteady growth reported by
\citet{peureux2021unsteady}.
Another important property of this solution is that the short-wave group that
experiences peak amplification (dampening) are not locked in to the long-wave
crests (troughs), as they are in the solution by \citet{longuet1960changes}.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{figures/fig_modulation_3panel_infinite_wave_train.png}
\caption{
  Change in the short-wave action (left), wavenumber (middle), and steepness (right)
  relative to their initial values as function of initial long-wave phase and time.
  $k_L = 1$, $k = 10$, $\varepsilon_L = 0.1$.
}
\label{fig:modulation_3panel_infinite}
\end{figure}

Why does this unsteady growth of short-wave action occur?
As \citet{peureux2021unsteady} explain, "the additional change in advection
velocity due to the modulation of the short wave group speed gives an additional
amplification."
That is, it is the inhomogeneity term $N \dfrac{\partial C_g}{\partial x}$ that
is responsible for the instability.
However, the instability only occurs if the short waves are initialized as a
uniform field.
If they are initialized instead as a periodic function of the long-wave phase
such that their wavenumber (and optionally, action) is higher on the crests
and lower in the troughs, akin to the prior steady solutions, the instability
does not occur.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{figures/fig_modulation_3panel_linear_ramp.png}
\caption{
  Same as Fig. \ref{fig:modulation_3panel_infinite} but with a linear ramp
  applied to $a_L$ during the initial five long-wave periods.
}
\label{fig:modulation_3panel_ramp}
\end{figure}

Why is it, then, that the solution for short-wave modulation is not only
quantitatively, but also qualitatively, different depending on the short-wave
initial conditions?
It may at first seem that there is something special about the uniform initial
conditions that makes its solutions grow unsteadily and indefinitely.
\citet{peureux2021unsteady} described this scenario as "...the sudden appearance
of a long wave perturbation in the middle of a homogeneous short wave field".
However, such a scenario is not realistic in the ocean where waves tend to
organize into groups due to their dispersive nature.
To test whether it is the sudden onset of long-wave forcing that causes the
unstable growth, we repeat the numerical simulation of Fig.
\ref{fig:modulation_3panel_infinite}, except for a linear ramp applied to $a_L$
(and consequently, $U$ and $W$ as well) for the first five periods:
$a_L(t) = min(a_L, a_L t / \left(5 T_L\right))$, where $T_L$ is the long-wave period.
This result is shown in Fig. \ref{fig:modulation_3panel_ramp}.
The key distinction that arises with the introduction of the ramp is that the
modulation pattern of short waves is now locked in with the long-wave crests,
and their indefinite steepening vanishes.
The stabilization effect of the long-wave ramp is more readily assessed in
Fig. \ref{fig:unsteady_growth_timeseries}, which shows the maximum short-wave
steepness modulation as function of time over 30 long-wave periods, for the
infinite long-wave train case and that when applying the linear ramp to the
long-wave forcing.
Comparing the wave action propagation ($C_g \frac{\partial N}{\partial x}$) and
inhomogeneity ($N \frac{\partial C_g}{\partial x}$) tendencies reveals that
after only one long-wave period, the propagation and inhomogeneity tendencies
are unbalanced and amplify the steepening of short waves
(Fig. \ref{fig:inhomogeneity_tendencies}).
Although \citet{peureux2021unsteady} correctly pointed out that the unstable
growth of short-wave steepness occurs due to the resonance of the inhomogeneity
tendency with the short-wave action perturbation, in case of a gentle ramp
up of the long-wave forcing, the propagation and inhomogeneity tendencies
mostly balance each other out, thus allowing the short-wave steepening to
lock in to the long-wave crests.

\begin{figure}
  \centering
  \includegraphics[width=0.6\textwidth]{figures/fig_modulation_ramp_timeseries.png}
  \caption{
    Maximum short-wave steepness modulation as function of time in case of
    infinite long-wave train case (blue) and the same case but with a linear
    ramp during the initial five long-wave periods (orange). The dashed black
    line corresponds to the short-wave steepness of 0.4 at which most waves are
    expected to break.
  }
  \label{fig:unsteady_growth_timeseries}
\end{figure}

\begin{figure}
  \centering
  \includegraphics[width=0.8\textwidth]{figures/inhomogeneity_tendencies.png}
  \caption{
    Propagation ($C_g \frac{\partial N}{\partial x}$) (blue) and inhomogeneity
    ($N \frac{\partial C_g}{\partial x}$) (orange) tendencies and their sum
    (green) for the short-wave action after one long-wave period, in the case of
    (a) infinite long-wave train and (b) linear ramp of long-wave amplitude.
    Dashed line is the long-wave elevation and the dotted line is the short-wave
    action modulation minus 1.
  }
  \label{fig:inhomogeneity_tendencies}
\end{figure}

\subsection{Short-wave modulation by long-wave groups}
\label{subsection:wave_groups}

We now proceed to examine the numerical solutions with the long-wave forcing
applied as a long-wave group.
The wave group is simulated as a non-dispersive train of long waves whose
amplitude scales with $\cos{2 \pi t / (N T_L)}$, where $N$ is the number of
long waves in the group.

\begin{figure}
\centering
\includegraphics[width=\textwidth]{figures/fig_modulation_3panel_wave_group.png}
\caption{
  Same as Fig. \ref{fig:modulation_3panel_infinite} but for a long-wave group,
  causing the long-wave amplitude to gradually increase and peak at $a_L = 0.1$
  after five long-wave periods, and then conversely decay back to a calm sea state.
}
\label{fig:modulation_3panel_groups}
\end{figure}

\section{Sensitivity to wavenumber ratios}
\label{section:sensitivity_to_wavenumber_ratios}

\section{Scale analysis}
\label{section:scale_analysis}

Now that we showed that the analytical solution is consistent with full numerical
solutions for $\varepsilon_L < 0.25$, we can use analytical solutions for scale
analysis to quantify the relative contribution of tendencies in the full equation set.

TODO

\section{Conclusions}
\label{section:conclusions}

In this paper we revisited the problem of short-wave modulation by long waves
from a linear wave theory perspective.
Using the linearized wave crest and action conservation equations, coupled with
the nonlinear gravity modulation for short waves that includes the the curvature
effects of the long wave, we derived new analytical solutions for the modulation
of short wave wavenumber, amplitude, steepness, intrinsic frequency, and phase
speed.
The latter two have not been previously examined in the context of short-wave
modulation, but are important for correctly calculating the wind input into
short waves, which is proportional to the wind speed relative to the wave
celerity.
The approximate steady solutions yield higher wavenumber and amplitude
modulation than that of \citet{longuet1960changes}, and somewhat lower than 
the numerical solutions of \citet{longuet1987propagation} and
\citet{zhang1990evolution}.
This is mainly due to the analytical solution requiring the crest and action
conservation equations to be linearized, and the nonlinearity arising only due
to the evaluation of short waves on the surface of the long wave (as opposed to
the mean water level) and due to nonlinear effective gravity.

The numerical solutions of the full wave crest and action conservation equations
are consistent with the analytical solutions for $\varepsilon_L < 0.2$.
The simulations also reveal that the unsteady growth of short-wave steepness
reported by \citet{peureux2021unsteady} is due to the sudden appearance of
long waves in a homogeneous short-wave field, a scenario that is unlikely to
occur in nature.
A more likely conditions, such as that of a long-wave groups, are only mildly
destabilizing for the short waves.
These results suggest that for mildly-to-moderately steep short waves,
the analytical steady solutions presented here are sufficient to describe the
modulation of short waves by long waves.

\backsection[Acknowledgements]{
Thanks to Nathan Laxague, Fabrice Ardhuin, Nick Pizzo, and Peisen Tan for the
helpful discussions.
}

\backsection[Funding]{
  Milan Curcic was partially supported by the National Science Foundation
  under grant number AGS-1745384.
}

\backsection[Declaration of interests]{The author reports no conflict of interest.}

\backsection[Data availability statement]{
  The data and code to generate the figures and run the numerical simulations
  are available at [TODO].
  The numerical model is available as a standalone package at [TODO].
  %See JFM's \href{https://www.cambridge.org/core/journals/journal-of-fluid-mechanics/information/journal-policies/research-transparency}{research transparency policy} for more information
}

\backsection[Author ORCIDs]{M. Curcic, https://orcid.org/0000-0002-8822-7749}

%\backsection[Author contributions]{Authors may include details of the contributions made by each author to the manuscript}

\bibliographystyle{jfm}
\bibliography{references}

\end{document}
